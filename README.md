# stock-analysis

## Background
Assignment was to create a VBA script for Steve to run stock analysis on. The script would loop through the excel sheet outputting the ticket name, total daily volume, and percent of ticket starting to end price for the year. Then added a button to the sheet to give Steve access to the information and data with just a click of the button. The script worked with the given data, but Steve mentioned he wanted to do more research which would include larger datasets. I then went back to see how the script could be refactored into something more efficient when looping through the data. 

![Both_Original](https://user-images.githubusercontent.com/56700719/148659954-82bbb091-9be4-4ecb-a22a-8448ea3356c6.PNG)
## Results
The purpose of the script is to loop through the dataset providing important information about the stock. The current dataset had 11 different tickers each with daily information about their stock making a total of 3013 lines on the sheet. The original script was written to loop all 3013 line 11 times, once for each ticker by fetching and storing the data into a variable. While this worked for the original dataset in mind, it wasn’t the most efficient way to loop through the data. Now with plans of larger datasets I went back to refactor the script to make it run smoothly with larger datasets by rewriting the script so it would only loop through the data once. The refactored script finds and stores the data into an array, with one node for each ticker. Now with one pass through the data, the script can find, calculate, store, and the output the information into a table for Steve. Another advantage of this new script is that it will save resources for the computer because it doesn’t have to keep track of multiple variables and loop through all the lines of data multiple times.

![Both_Refactored](https://user-images.githubusercontent.com/56700719/148659973-ba27e8f6-4fb7-4e98-bb76-ee7fb4dd5c21.PNG)
## Summary
The refactored script was able to cut almost half a second off the time it took for the original script to run. With only running through 3000 lines, this is still a large amount of time saved from the original. A big disadvantage of refactoring code is having to spend more time on already completed and working code. While maybe getting it right the first time may help, more times than not the stipulation for what needs to be achieved changes. This request is a good example of why refactoring helps. Steve like how well the original script worked, he wanted to use it more on larger datasets, but it wouldn’t work as well on larger datasets as it did with a smaller one. By going back and changing a few things I was able to make the new script work better than the original and keep the client, Steve, happy.
